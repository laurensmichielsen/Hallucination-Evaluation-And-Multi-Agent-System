# Hallucination-Evaluation-And-Multi-Agent-System

## Project Overview
This project implements a **multi-agent medical question answering and clinical case analysis system**.  
Instead of relying on a single generic language model, the system uses **role-aligned medical agents** to improve correctness, safety, and interpretability.

The pipeline combines:
- **Domain-specialist reasoning**
- **Doctor-level synthesis**
- **Nurse-level patient communication**

This design reduces hallucinations and improves reliability compared to standard single-LLM approaches.

---

## Key Idea
The system enforces two goals simultaneously:
1. **Medical correctness** through specialist and doctor agents
2. **Patient communication safety** through a nurse agent

Standard LLMs often struggle to achieve both at the same time.  
This architecture separates reasoning from explanation to solve that problem.

---

## Agent Roles and Responsibilities

### Cardiology Agent
- Provides cardiology-focused clinical reasoning
- Identifies heart and circulation-related considerations
- Uses only retrieved cardiology documents
- Avoids answering outside its domain

---

### Dermatology Agent
- Provides skin-related assessment and differential diagnosis insights
- Uses dermatology-specific retrieved documents
- Restricts answers to dermatology scope

---

### Doctor Agent (Clinical Synthesizer)
- Combines outputs from Cardiology and Dermatology agents
- Produces a unified clinical reasoning result
- Resolves conflicts and summarizes key findings
- Does not introduce unsupported medical claims

---

### Nurse Agent (Patient-Facing Interpreter)
- Translates the doctorâ€™s output into clear, non-technical language
- Emphasizes empathy, clarity, and safety
- Adds guidance on when to seek medical attention
- **Does not generate new diagnoses or medical decisions**

---

## System Pipeline

1. User submits a question or clinical case
2. Input is routed to:
   - Cardiology Agent
   - Dermatology Agent
3. Specialist outputs are passed to the Doctor Agent
4. Doctor Agent produces a synthesized clinical response
5. Nurse Agent rewrites the response into patient-friendly language
6. Final answer is returned to the user

---

## Retrieval and Context Grounding
- Each specialist agent retrieves information from its own document corpus
- Only retrieved content is used to generate responses
- If relevant information is missing, the system responds with uncertainty instead of hallucinating

This retrieval-based grounding significantly improves factual reliability.

---

## Model and Prompting Strategy
- Base model: Loaded via HuggingFace Transformers
- Each agent uses a **role-specific system prompt** that enforces:
  - domain constraints
  - grounding to retrieved context
  - safety and refusal behavior when information is insufficient
- The Doctor prompt focuses on synthesis and consistency
- The Nurse prompt forbids introducing new medical claims

---

## How to Run

### Run on Google Colab (Preferred: A100 GPU)
This project is designed to run on **Google Colab**, preferably using an **A100 GPU** for best performance.

1. Upload all project files (including `multi_agent_documented.ipynb` and the document folders) to your Colab environment.
2. Open the notebook and set the runtime to **GPU (A100 if available)**.
3. **Do not forget to add your Hugging Face access token** (required for model loading):
   - Store it as an environment variable (`HF_TOKEN`) or
   - Add it securely in the notebook using Colab secrets.
4. Install the required dependencies in the first code cell.
5. Execute all cells sequentially.

### User Interface (Gradio)
In the **final code cell**, the system launches a **Gradio web interface**.

- A **Gradio link** will appear in the output after execution.
- Click the link to interact with the multi-agent system through a browser-based UI.
- The UI allows you to submit medical questions or clinical cases and view responses generated by the multi-agent pipeline.

No local setup is required when running through Google Colab.
